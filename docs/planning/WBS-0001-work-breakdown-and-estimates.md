# WBS-0001 — Work Breakdown Structure и оценка трудозатрат (порт Chainsaw Rust → C++)

## Статус
- Версия: 1
- Статус: Draft (To‑Be planning)
- Единица оценки: **человеко‑день (ч/д)**, 1 ч/д = 8 часов.
- Тип оценки: плановая трудоёмкость уровня **P50** (медианная), без календарного графика.

## Входы (Single Source of Truth)
- Постановка (границы/DoD продукта): `docs/requirements/TASK-0001-problem-statement.md`.
- Требования `REQ-*`: `docs/requirements/AR-0001-architectural-requirements.md`.
- To‑Be модульные границы `MOD-*`: `docs/architecture/TOBE-0001-cpp-to-be-architecture.md`.
- Test‑to‑test база `TST-*`: `docs/tests/TESTMAT-0001-rust-test-matrix.md`.
- Golden runs `RUN-*`: `docs/reports/REP-0001-rust-golden-runs.md`.
- Риски/допущения `RISK-*`:.

## Цель документа
1) Зафиксировать WBS (что именно нужно сделать дальше по плану).
2) Дать оценку трудоёмкости по пакетам работ.
3) Обеспечить трассируемость **«работа → REQ / FEAT / TST / RUN / RISK / MOD»** без дублирования источников истины.

---

## 0) Метод оценки и допущения

### 0.1. Что оценивается
- Оценивается **трудоёмкость выполнения работ** (реализация + тесты + доказательства 1:1 + сопровождающая документация/отчёты в рамках соответствующих шагов).
- Не оценивается календарный график (зависит от доступных ресурсов, параллелизма задач, CI‑времени, внешних согласований по лицензиям и данным).

### 0.2. Как читать неопределённость
Для каждого пакета работ указывается уровень неопределённости:
- **Low** — понятны источники истины (TST/RUN), есть прямые проверки и нет нерешённых технологических развилок.
- **Medium** — требуется интеграция зависимостей/кроссплатформенная доводка или есть ограниченные unknowns.
- **High** — есть открытые решения (pending ADR), отсутствуют данные/фикстуры, либо высокий риск платформенных расхождений.

### 0.3. Буферы
Открытые риски P1 (например, RISK-0003/0006/0011/0030/0031/0032/0022) создают существенную неопределённость. Поэтому оценка приводится как:
- **Base (P50)** — сумма базовых оценок по WBS.
- **Risk buffer** — резерв на интеграционные/платформенные/данные‑риски.

Резерв задаётся **над проектом в целом**, а не «размазывается» по строкам (чтобы сохранить прозрачность).

---

## 1) WBS по шагам плана и пакетам работ

> Примечание: элементы WBS ниже специально «склеивают» в одном месте: (а) реализацию, (б) перенос тестов/проверок, (в) обновления трассируемости/рисков. Это нужно для обеспечения DoD по эквивалентности 1:1.

### 1.1. Блок D (–23) — доведение пакета To‑Be до формального старта реализации

#### WBS-1.1 —: Практическое руководство разработчика
- Результат: developer guide (стандарты кода/тестов/безопасности/кроссплатформенности), согласованный с AR/ADR/To‑Be.
- Зависимости: завершённые /18/19.
- Оценка: **3 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-NFR-0014, REQ-SEC-0017…REQ-SEC-0022, REQ-OPS-0023…REQ-OPS-0030.
 - MOD: MOD-0001…MOD-0015 (правила разработки и границы модулей).
 - RISK: RISK-0011, RISK-0031, RISK-0032.

#### WBS-1.2 —: Пакет согласования архитектуры
- Результат: checklist/шаблон протокола согласования старта реализации; критерии «готово к ».
- Зависимости: WBS-1.1, WBS-0001 (текущий документ).
- Оценка: **2 ч/д** (Low).
- Трассируемость:
 - REQ: REQ-NFR-0014.
 - RISK: RISK-0008, RISK-0009, RISK-0010 (как входы в критерии согласования).

#### WBS-1.3 —: Аудит консистентности документов №1
- Результат: отчёт аудита + правки документов To‑Be, устраняющие противоречия/дубли.
- Зависимости: WBS-1.1, WBS-1.2.
- Оценка: **2 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-NFR-0014.
 - RISK: (как минимум) RISK-0011 (чтобы не было конфликтов в политике детерминизма/вывода).

---

### 1.2. Блок E (–28) — инженерный фундамент C++

#### WBS-2.1 —: Минимально собираемый C++‑скелет + CLI поверхность (заглушки)
- Результат: сборка/запуск (минимум в одной ОС) + «каркас» CLI (команды/подкоманды/флаги) без бизнес‑логики.
- Зависимости: WBS-1.1…WBS-1.3; To‑Be `MOD-*`.
- Оценка: **4 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-OPS-0023…REQ-OPS-0026, REQ-FR-0001.
 - MOD: MOD-0001, MOD-0002, MOD-0003.
 - RUN:… (как будущие проверки CLI).
 - RISK: RISK-0031 (сложность 1:1 help/errors), RISK-0032 (кроссплатформенная сборка зависимостей).

#### WBS-2.2 —: Интеграция quality gates
- Результат: политики «зелёного состояния» + конфигурации инструментов качества (форматирование/санитайзеры/предупреждения).
- Зависимости: WBS-2.1.
- Оценка: **3 ч/д** (Low).
- Трассируемость:
 - REQ: REQ-OPS-0024, REQ-SEC-0017.

#### WBS-2.3 —: CI кроссплатформенный (Windows/Linux/macOS)
- Результат: CI, собирающий и запускающий тесты в матрице целевых ОС.
- Зависимости: WBS-2.1, WBS-2.2.
- Оценка: **5 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-NFR-0012, REQ-OPS-0023…REQ-OPS-0026.
 - RISK: RISK-0032.

#### WBS-2.4 —: Harness сравнения (Rust vs C++) по golden runs
- Результат: воспроизводимый diff‑harness, отчёт совпадений/расхождений по `RUN-*` внутри платформы.
- Зависимости: WBS-2.1, WBS-2.3; эталоны.
- Оценка: **6 ч/д** (High).
- Трассируемость:
 - REQ: REQ-NFR-0015, REQ-NFR-0016.
 - RUN: все `RUN-*` из `REP-0001`.
 - RISK: RISK-0011 (детерминизм), RISK-0007 (пути/пробелы), RISK-0028/0029 (качество Windows эталонов).

#### WBS-2.5 —: Политика тестовых данных (EVTX/Sigma/фикстуры)
- Результат: правила хранения/получения тестовых данных + минимальный набор фикстур для test‑to‑test и golden runs.
- Зависимости: WBS-2.4 (понятно, что именно нужно harness’у).
- Оценка: **4 ч/д** (High).
- Трассируемость:
 - REQ: REQ-OPS-0027…REQ-OPS-0030.
 - TST: TST-0001…TST-0008 (фикстуры EVTX/SRUM/Sigma), косвенно — все.
 - RISK: RISK-0003 (политика данных), RISK-0006 (версии sigma/EVTX), RISK-0008/0009/0010 (лицензии), RISK-0022 (shimcache данные).

---

### 1.3. Блок F (–30) — подготовка цикла портирования

#### WBS-3.1 —: Портинг‑бэклог (вертикальные слайсы)
- Результат: упорядоченный backlog слайсов, каждый с micro‑spec ссылками на источники и критериями UnitReady/UnitDone.
- Зависимости: WBS-2.4…WBS-2.5 (есть инфраструктура доказательств).
- Оценка: **3 ч/д** (Medium).
- Трассируемость:
 - FEAT: FEAT-0001…FEAT-0011.
 - TST: TST-0001…TST-0022.
 - RUN:….
 - RISK: RISK-0011, RISK-0030, RISK-0031, RISK-0032 (как факторы гранулярности).

#### WBS-3.2 —: Iteration playbook (шаблон выходов одной итерации)
- Результат: единый runbook/шаблон micro‑spec, отчётов прогонов, диффов, обновлений реестров.
- Зависимости: WBS-3.1.
- Оценка: **2 ч/д** (Low).
- Трассируемость:
 - REQ: REQ-NFR-0014.

---

### 1.4. Блок F (–33) — реализация вертикальных слайсов (обобщённая WBS)

> Каждый из элементов WBS-4.* предполагает повторяющийся цикл: (UnitReady), (Unit implementation), (UnitDone verification).

#### WBS-4.1 — Реализация MOD-0001/MOD-0002: CLI контракт 1:1 (ядро)
- Результат:
 - парсинг argv;
 - генерация `--help/--version` и сообщения об ошибках/usage;
 - глобальные флаги (`--no-banner`, `--num-threads`, `-v`, и др. по `CLI-0001`), без функциональной логики команд.
- Зависимости: WBS-2.1…WBS-2.4.
- Оценка: **12 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0001, REQ-NFR-0015, REQ-NFR-0016.
 - FEAT: FEAT-0001.
 - MOD: MOD-0001, MOD-0002.
 - RUN:….
 - RISK: RISK-0031, RISK-0028, RISK-0029.

#### WBS-4.2 — Реализация MOD-0003: слой пользовательского вывода (stdout/stderr/file)
- Результат:
 - единый writer для stdout/stderr и file output;
 - форматы `Std/JSON/JSONL/CSV/log` + таблицы (включая ANSI/unicode как часть байтового вывода);
 - гарантии детерминизма сериализации (каноникализация).
- Зависимости: WBS-4.1.
- Оценка: **15 ч/д** (High).
- Трассируемость:
 - REQ: REQ-NFR-0015, REQ-NFR-0016.
 - FEAT: FEAT-0009.
 - MOD: MOD-0003.
 - TST: TST-0001…TST-0006 (stdout byte‑to‑byte), косвенно — все CLI сценарии.
 - RISK: RISK-0011.

#### WBS-4.3 — Реализация MOD-0004: platform (paths/encoding/fs helpers/tty/temp)
- Результат:
 - политика path ⇄ UTF‑8 и поведение ошибок путей;
 - утилиты временных файлов/директорий;
 - кроссплатформенные детали, влияющие на stdout/stderr.
- Зависимости: WBS-2.1.
- Оценка: **6 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-NFR-0012, REQ-SEC-0018.
 - MOD: MOD-0004.
 - RISK: RISK-0007.

#### WBS-4.4 — Реализация MOD-0005/MOD-0006: discovery + Reader (детерминизм, load_unknown, skip_errors)
- Результат:
 - сбор файлов/директорий и детерминизация порядка;
 - логика выбора парсера по расширению и fallback `--load-unknown`;
 - семантика `--skip-errors` (stdout/stderr/exit code) и сообщений об ошибке.
- Зависимости: WBS-4.1…WBS-4.3.
- Оценка: **10 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0009, REQ-NFR-0011, REQ-NFR-0015.
 - FEAT: FEAT-0008.
 - MOD: MOD-0005, MOD-0006.
 - RISK: RISK-0011.

#### WBS-4.5 — Реализация MOD-0007: парсеры JSON/JSONL/XML (базовый набор)
- Результат: поддержка форматов `.json`, `.jsonl`, `.xml` согласно `DATA-0001` (включая edge cases чтения и ошибок).
- Зависимости: WBS-4.3…WBS-4.4.
- Оценка: **7 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0009, REQ-SEC-0017.
 - MOD: MOD-0007.
 - RISK: RISK-0026 (XML ветки и различия библиотек).

#### WBS-4.6 — Реализация MOD-0007: парсер EVTX
- Результат: поддержка `.evt/.evtx`, совместимая с Rust baseline (включая структуру JSON, алиасы полей и правила поиска).
- Зависимости: WBS-4.4…WBS-4.5.
- Оценка: **15 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0002, REQ-FR-0003, REQ-FR-0004.
 - FEAT: FEAT-0007, FEAT-0003, FEAT-0002.
 - MOD: MOD-0007.
 - TST: TST-0001…TST-0004.
 - RUN:…,…,….
 - RISK: RISK-0030.

#### WBS-4.7 — Реализация MOD-0007: парсер ESEDB (libesedb)
- Результат: поддержка `.dat/.edb` согласно `DATA-0001` (структура JSON записей, конверсия типов, UTC timestamps).
- Зависимости: WBS-4.3…WBS-4.4.
- Оценка: **12 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-FR-0006, REQ-FR-0009.
 - FEAT: FEAT-0011.
 - MOD: MOD-0007.
 - TST: TST-0005…TST-0006.
 - RUN:….
 - RISK: RISK-0032.

#### WBS-4.8 — Реализация MOD-0007: парсер HVE (Registry Hive)
- Результат: поддержка `.hve` и поведения recovery‑логов/предупреждений согласно `DATA-0001`.
- Зависимости: WBS-4.3…WBS-4.4.
- Оценка: **12 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0006, REQ-FR-0007, REQ-FR-0009.
 - MOD: MOD-0007.
 - RISK: RISK-0030, RISK-0032.

#### WBS-4.9 — Реализация MOD-0007: парсер MFT + извлечение data streams
- Результат: поддержка `.mft/.bin/$MFT` + правила извлечения потоков/ошибок (включая недетерминированные имена — см. RISK-0025).
- Зависимости: WBS-4.3…WBS-4.4.
- Оценка: **10 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0004, REQ-FR-0009.
 - FEAT: FEAT-0002.
 - MOD: MOD-0007.
 - RISK: RISK-0025, RISK-0030.

#### WBS-4.10 — Реализация MOD-0008: Chainsaw rules (YAML) — загрузка/валидация
- Результат: загрузка Chainsaw YAML правил, проверка расширений/ошибок, подготовка к `hunt` и `lint`.
- Зависимости: WBS-4.5.
- Оценка: **6 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-FR-0003, REQ-FR-0005.
 - FEAT: FEAT-0004, FEAT-0006.
 - MOD: MOD-0008.

#### WBS-4.11 — Реализация MOD-0008: Sigma load/convert/optimize + test-to-test (TST-0007…TST-0022)
- Результат:
 - sigma YAML parsing, multi‑doc support;
 - конвертация detection/condition в Tau/YAML;
 - оптимизации выражений;
 - перенос тестов `TST-0007…TST-0022` как эквивалентных проверок.
- Зависимости: WBS-4.5, WBS-4.12.
- Оценка: **18 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-FR-0008.
 - FEAT: FEAT-0005.
 - MOD: MOD-0008.
 - TST: TST-0007…TST-0022.
 - RUN:.
 - RISK: RISK-0006.

#### WBS-4.12 — Реализация MOD-0009: Tau engine (IR + парсер выражений + solver)
- Результат: совместимость выражений и операторов с baseline (включая совместимость с путями и модификаторами Sigma‑конвертации).
- Зависимости: WBS-4.4, WBS-4.5.
- Оценка: **12 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0002, REQ-FR-0003, REQ-FR-0008.
 - MOD: MOD-0009.
 - TST: TST-0001…TST-0004, TST-0007…TST-0022.

#### WBS-4.13 — Реализация MOD-0010: команда `dump`
- Результат: `dump` по входным артефактам с форматами вывода Std/JSON/JSONL, включая `--load-unknown`/`--skip-errors`.
- Зависимости: WBS-4.2, WBS-4.4…WBS-4.9.
- Оценка: **6 ч/д** (Medium).
- Трассируемость:
 - REQ: REQ-FR-0004.
 - FEAT: FEAT-0002.
 - MOD: MOD-0010.
 - RUN:….

#### WBS-4.14 — Реализация MOD-0011: команда `search` + test-to-test (TST-0001…TST-0003)
- Результат: `search` (regex/tau, фильтры времени, форматы вывода) + перенос тестов stdout byte‑to‑byte.
- Зависимости: WBS-4.2, WBS-4.4, WBS-4.6, WBS-4.12.
- Оценка: **10 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0002.
 - FEAT: FEAT-0007.
 - MOD: MOD-0011.
 - TST: TST-0001…TST-0003.
 - RUN:….

#### WBS-4.15 — Реализация MOD-0012: команда `hunt` + test-to-test (TST-0004)
- Результат: `hunt` по Chainsaw rules, включая `--cache-to-disk`, форматы вывода и детерминизм.
- Зависимости: WBS-4.2, WBS-4.4, WBS-4.6, WBS-4.10…WBS-4.12.
- Оценка: **14 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0003.
 - FEAT: FEAT-0003, FEAT-0004.
 - MOD: MOD-0012.
 - TST: TST-0004.
 - RUN:….
 - RISK: RISK-0014, RISK-0011.

#### WBS-4.16 — Реализация MOD-0013: команда `lint`
- Результат: `lint` для `--kind` baseline (chainsaw/sigma), включая ошибки/exit codes.
- Зависимости: WBS-4.10…WBS-4.11.
- Оценка: **5 ч/д** (Low).
- Трассируемость:
 - REQ: REQ-FR-0005.
 - FEAT: FEAT-0006.
 - MOD: MOD-0013.
 - RUN:…,.

#### WBS-4.17 — Реализация MOD-0014: `analyse srum` + test-to-test (TST-0005…TST-0006)
- Результат: `analyse srum` (табличный режим `--stats-only` и JSON режим) + перенос тестов stdout byte‑to‑byte.
- Зависимости: WBS-4.2, WBS-4.7…WBS-4.8.
- Оценка: **16 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0006.
 - FEAT: FEAT-0011.
 - MOD: MOD-0014.
 - TST: TST-0005…TST-0006.
 - RUN:….
 - RISK: RISK-0003 (фикстуры большие), RISK-0032.

#### WBS-4.18 — Реализация MOD-0015: `analyse shimcache` + добавление данных/сценариев
- Результат: реализация shimcache + закрытие «дыры» в доказательствах (получение/создание разрешённых фикстур + новые `RUN-*`).
- Зависимости: WBS-2.5 (политика данных), WBS-4.8.
- Оценка: **12 ч/д** (High).
- Трассируемость:
 - REQ: REQ-FR-0007.
 - FEAT: FEAT-0010.
 - MOD: MOD-0015.
 - RISK: RISK-0022.

---

### 1.5. Блок G (–44) — закрытие gaps, hardening и релизная готовность

#### WBS-5.1 —: Gap analysis parity (REQ/FEAT/TST/RUN)
- Результат: отчёт о незакрытых требованиях/фичах/тестах + план закрытия.
- Зависимости: WBS-4.* (существенная часть функциональности должна быть реализована).
- Оценка: **5 ч/д** (Medium).

#### WBS-5.2 —: План расширения тестов (поведенческое покрытие)
- Результат: список дополнительных тестов/сценариев сверх upstream (негативные кейсы, большие данные, platform edge cases).
- Зависимости: WBS-5.1.
- Оценка: **3 ч/д** (Medium).

#### WBS-5.3 —: Реализация расширенных тестов + интеграция в CI
- Результат: дополнительные тесты/фикстуры/скрипты, закрывающие gaps и критические риски.
- Зависимости: WBS-5.2.
- Оценка: **10 ч/д** (High).

#### WBS-5.4 —: Профилирование производительности (база)
- Результат: профили (CPU/mem/I/O) на репрезентативных данных, базовые метрики.
- Зависимости: WBS-4.* (работающий функционал).
- Оценка: **6 ч/д** (Medium).

#### WBS-5.5 —: Оптимизации производительности (без изменения поведения)
- Результат: улучшения perf с доказательством отсутствия регрессий 1:1 через harness.
- Зависимости: WBS-5.4.
- Оценка: **10 ч/д** (High).

#### WBS-5.6 —: Security hardening (обработка недоверенных входов)
- Результат: усиление обработки данных/лимитов/ошибок, снижение поверхности уязвимостей.
- Зависимости: WBS-4.*.
- Оценка: **8 ч/д** (High).
- Трассируемость:
 - REQ: REQ-SEC-0017…REQ-SEC-0022.

#### WBS-5.7 —: Packaging / дистрибутив (кроссплатформенно)
- Результат: сборочные артефакты/пакеты и правила распространения (без нарушения лицензий).
- Зависимости: WBS-4.*.
- Оценка: **12 ч/д** (High).
- Трассируемость:
 - REQ: REQ-OPS-0023…REQ-OPS-0030.
 - RISK: RISK-0008, RISK-0009, RISK-0010.

#### WBS-5.8 —: Cross‑platform e2e validator
- Результат: валидатор, подтверждающий сборку/запуск/1:1 сравнение по выбранным сценариям в целевых ОС.
- Зависимости: WBS-2.4, WBS-4.*.
- Оценка: **8 ч/д** (Medium).

#### WBS-5.9 —: Финальный аудит документации
- Результат: устранение конфликтов/дублей, согласование SoT и трассируемости.
- Зависимости: WBS-5.1…WBS-5.8.
- Оценка: **3 ч/д** (Low).

#### WBS-5.10 —: Release Candidate package + аудит лицензий
- Результат: RC‑сборка + итоговый лицензионный аудит third_party и данных.
- Зависимости: WBS-5.7.
- Оценка: **6 ч/д** (High).

#### WBS-5.11 —: План сопровождения и handoff
- Результат: runbooks/процедуры сопровождения, обновлений зависимостей и регресса.
- Зависимости: WBS-5.10.
- Оценка: **2 ч/д** (Low).

---

## 2) Сводная оценка трудоёмкости

### 2.1. Сумма base‑оценок (P50)

| Группа работ | WBS диапазон | Base, ч/д |
|---|---|---:|
| Блок D: завершение To‑Be (–23) | WBS-1.1…WBS-1.3 | 7 |
| Блок E: инженерный фундамент (–28) | WBS-2.1…WBS-2.5 | 22 |
| Блок F: подготовка цикла (–30) | WBS-3.1…WBS-3.2 | 5 |
| Блок F: реализация слайсов (–33, суммарно) | WBS-4.1…WBS-4.18 | 198 |
| Блок G: закрытие/hardening (–44) | WBS-5.1…WBS-5.11 | 73 |
| **Итого Base (P50)** | | **305** |

### 2.2. Резерв на риски (risk buffer)

Рекомендуемый резерв: **+30%** от Base на интеграционные/платформенные/данные‑риски.
- Обоснование: доля задач с High‑неопределённостью велика (EVTX/HVE/MFT/XML, CLI 1:1, harness, shimcache данные) и есть открытые P1 риски.

| Метрика | Значение |
|---|---:|
| Base (P50), ч/д | 305 |
| Risk buffer (+30%), ч/д | 92 |
| **Итого с резервом (ориентир P90), ч/д** | **397** |

---

## 3) Матрицы покрытия (трассируемость)

### 3.1. Покрытие требований `REQ-*` → WBS

| REQ-ID | Закрывается работами |
|---|---|
| REQ-FR-0001 | WBS-2.1, WBS-4.1 |
| REQ-FR-0002 | WBS-4.6, WBS-4.12, WBS-4.14 |
| REQ-FR-0003 | WBS-4.6, WBS-4.10, WBS-4.11, WBS-4.12, WBS-4.15 |
| REQ-FR-0004 | WBS-4.6, WBS-4.7, WBS-4.8, WBS-4.9, WBS-4.13 |
| REQ-FR-0005 | WBS-4.10, WBS-4.11, WBS-4.16 |
| REQ-FR-0006 | WBS-4.7, WBS-4.8, WBS-4.17 |
| REQ-FR-0007 | WBS-2.5, WBS-4.8, WBS-4.18 |
| REQ-FR-0008 | WBS-4.11, WBS-4.12 |
| REQ-FR-0009 | WBS-4.4…WBS-4.9 |
| REQ-NFR-0010 | WBS-2.1…WBS-2.4, WBS-5.8 |
| REQ-NFR-0011 | WBS-4.4, WBS-4.14, WBS-4.15 |
| REQ-NFR-0012 | WBS-2.3, WBS-4.3 |
| REQ-NFR-0013 | WBS-4.17 |
| REQ-NFR-0014 | WBS-1.1…WBS-1.3, WBS-3.2, WBS-5.1, WBS-5.9 |
| REQ-NFR-0015 | WBS-2.4, WBS-4.1…WBS-4.2 |
| REQ-NFR-0016 | WBS-2.4, WBS-4.1…WBS-4.2 |
| REQ-SEC-0017 | WBS-2.2, WBS-4.5, WBS-5.6 |
| REQ-SEC-0018 | WBS-4.3, WBS-5.6 |
| REQ-SEC-0019 | WBS-4.4, WBS-5.6 |
| REQ-SEC-0020 | WBS-4.9, WBS-5.6 |
| REQ-SEC-0021 | WBS-4.2, WBS-5.6 |
| REQ-SEC-0022 | WBS-5.6 |
| REQ-OPS-0023 | WBS-2.1, WBS-2.3, WBS-5.7 |
| REQ-OPS-0024 | WBS-2.2, WBS-5.7 |
| REQ-OPS-0025 | WBS-2.1…WBS-2.3 |
| REQ-OPS-0026 | WBS-2.1…WBS-2.3 |
| REQ-OPS-0027 | WBS-2.5, WBS-5.7 |
| REQ-OPS-0028 | WBS-2.5, WBS-5.7 |
| REQ-OPS-0029 | WBS-2.5, WBS-5.7, WBS-5.10 |
| REQ-OPS-0030 | WBS-2.5, WBS-5.7, WBS-5.10 |

### 3.2. Покрытие фич `FEAT-*` → WBS

| FEAT-ID | Закрывается работами |
|---|---|
| FEAT-0001 (global flags/banner/threadpool) | WBS-4.1 |
| FEAT-0002 (dump) | WBS-4.13 |
| FEAT-0003 (hunt) | WBS-4.15 |
| FEAT-0004 (Chainsaw rules YAML) | WBS-4.10, WBS-4.15 |
| FEAT-0005 (Sigma load/convert) | WBS-4.11 |
| FEAT-0006 (lint) | WBS-4.16 |
| FEAT-0007 (search) | WBS-4.14 |
| FEAT-0008 (file read/identify) | WBS-4.4 |
| FEAT-0009 (writer/formats) | WBS-4.2 |
| FEAT-0010 (analyse shimcache) | WBS-4.18 |
| FEAT-0011 (analyse srum) | WBS-4.17 |

### 3.3. Покрытие test‑to‑test `TST-*` → WBS

| TST-ID | Закрывается работами |
|---|---|
| TST-0001…TST-0003 | WBS-4.14 |
| TST-0004 | WBS-4.15 |
| TST-0005…TST-0006 | WBS-4.17 |
| TST-0007…TST-0022 | WBS-4.11 |

### 3.4. Покрытие ключевых рисков `RISK-*` → WBS (минимум)

| RISK-ID | Митигируется работами |
|---|---|
| RISK-0003 (политика данных) | WBS-2.5, WBS-4.17 |
| RISK-0006 (версии sigma/EVTX) | WBS-2.5, WBS-4.11 |
| RISK-0008/0009/0010 (лицензии) | WBS-1.2, WBS-2.5, WBS-5.7, WBS-5.10 |
| RISK-0011 (детерминизм вывода) | WBS-2.4, WBS-4.2, WBS-4.15 |
| RISK-0014 (cache-to-disk) | WBS-4.15 |
| RISK-0022 (нет данных shimcache) | WBS-2.5, WBS-4.18 |
| RISK-0025 (недетерминированные имена MFT streams) | WBS-4.9 |
| RISK-0028/0029 (Windows golden runs) | WBS-2.4, WBS-4.1 |
| RISK-0030 (парсеры форензик‑форматов) | WBS-4.5…WBS-4.9 |
| RISK-0031 (CLI help/errors 1:1) | WBS-4.1 |
| RISK-0032 (C‑зависимости libyal) | WBS-2.3, WBS-4.7…WBS-4.9 |

---

## 4) Замечания к применению WBS в реальном цикле портирования

1) WBS-4.* — это «обобщённый план». Фактическая реализация пойдёт через –33 как **слайсы**, которые при необходимости будут дробиться по правилам S1–S4.
2) Приоритет слайсов должен следовать правилам (ценность для harness/снижение неопределённости/платформенные риски/«много тестов — мало изменений»).
3) Любые изменения, влияющие на наблюдаемое поведение, подтверждаются либо `TST-*`, либо `RUN-*` через harness согласно `GOV-0002`.
