# GOV-0003 — Пакет согласования архитектуры и критерии «готово к старту реализации»

## Назначение
Этот документ задаёт **формальный, воспроизводимый пакет согласования** для завершения фазы To‑Be архитектуры (–22) и подготовки к старту фазы реализации (–28).

Пакет состоит из:
1) **чек‑листа согласования** (что именно проверяем и по каким источникам);
2) **шаблона протокола** (как фиксируем результат согласования);
3) **критериев “готово к старту реализации”** (какие условия должны быть выполнены перед началом ).

Документ **не заменяет** SoT‑документы постановки/требований/решений/архитектуры/плана работ — он лишь задаёт процедуру их формальной приёмки.

## Входы (Single Source of Truth)
Обязательный набор документов, подлежащих согласованию:

- Постановка задачи (границы/сценарии/приёмка): `TASK-0001` — `docs/requirements/TASK-0001-problem-statement.md`
- Архитектурные требования (FR/NFR/SEC/OPS, `REQ-*`): `AR-0001` — `docs/requirements/AR-0001-architectural-requirements.md`
- ADR baseline (ключевые решения): `ADR-0001...ADR-0011` — `docs/adr/*` + индекс
- To‑Be архитектура (модули `MOD-*`, потоки, As‑Is→To‑Be): `TOBE-0001` — `docs/architecture/TOBE-0001-cpp-to-be-architecture.md`
- WBS и оценка трудозатрат (с трассировкой): `WBS-0001` — `docs/planning/WBS-0001-work-breakdown-and-estimates.md`
- Практическое руководство разработчика: `GUIDE-0001` — `docs/guide/GUIDE-0001-developer-guide.md`

Дополнительные обязательные источники управления (governance):
- Схема SoT/трассируемости: `GOV-0001` — `docs/governance/GOV-0001-traceability-and-sot.md`
- Критерии 1:1: `GOV-0002` — `docs/governance/GOV-0002-equivalence-criteria.md`
- Риски/допущения:
- Реестр артефактов:
- Трассируемость (минимум):
- Политика third‑party и тестовых данных: `POL-0001` — `docs/licensing/POL-0001-third-party-policy.md`
- Реестр лицензий C++ зависимостей: `LIC-0002` — `docs/licensing/LIC-0002-cpp-dependencies.md`

## Выходы применения пакета
1) Заполненный чек‑лист (как минимум — в составе протокола).
2) Протокол согласования архитектуры (файл в `docs/reports/`).
3) Решение: **PASS / PASS-with-risks / FAIL**.
4) Список принятых рисков/исключений и план корректировок (если требуется).

---

## 1) Чек‑лист согласования архитектуры

**Инструкция по использованию:**
- Чек‑лист проходит по порядку.
- Для каждого пункта фиксируется: “PASS/FAIL/N/A” + ссылка на доказательство (файл/раздел/ID).
- Если пункт FAIL — в протокол добавляется action item с владельцем и целевой датой.

### 1.1. Проверка полноты пакета документов (комплектность)

| № | Проверка | Критерий PASS | Доказательство (ссылка) | Статус | Комментарий / Action |
|---:|---|---|---|---|---|
| 1 | Наличие постановки `TASK-0001` | Файл существует, содержит версии/ссылки на As‑Is и `GOV-0002` | `docs/requirements/TASK-0001-problem-statement.md` | | |
| 2 | Наличие требований `AR-0001` | Файл существует, содержит полный список `REQ-*` и правила верификации | `docs/requirements/AR-0001-architectural-requirements.md` | | |
| 3 | Наличие ADR baseline | Все `ADR-0001...` присутствуют, перечислены в | `docs/adr/*`, | | |
| 4 | Наличие To‑Be архитектуры `TOBE-0001` | Файл существует, определяет `MOD-*`, потоки и As‑Is→To‑Be | `docs/architecture/TOBE-0001-cpp-to-be-architecture.md` | | |
| 5 | Наличие WBS `WBS-0001` | Файл существует, есть трассировка работ к `REQ/FEAT/TST/RUN/RISK/MOD` | `docs/planning/WBS-0001-work-breakdown-and-estimates.md` | | |
| 6 | Наличие developer guide `GUIDE-0001` | Файл существует, правила проверяемы и согласованы с `REQ-*`/`ADR-*` | `docs/guide/GUIDE-0001-developer-guide.md` | | |
| 7 | Governance‑документы | `GOV-0001` и `GOV-0002` присутствуют и используются как SoT | `docs/governance/GOV-0001-*.md`, `docs/governance/GOV-0002-*.md` | | |
| 8 | Реестры проекта |,,, актуальны | файлы в корне репозитория | | |
| 9 | Политики лицензий/данных | `POL-0001` и `LIC-0002` присутствуют | `docs/licensing/*` | | |

### 1.2. Проверка требований и критериев проверки (управляемость “что такое Done”)

> Цель: убедиться, что **каждое требование проверяемо**, а критерии 1:1 не подразумевают “доверия на слово”.

| № | Проверка | Критерий PASS | Связанные `REQ-*` | Доказательство (ссылка) | Статус | Комментарий / Action |
|---:|---|---|---|---|---|---|
| 10 | Критерии 1:1 формализованы | В `GOV-0002` определены сравнения stdout/stderr/exit code/FS‑эффектов и типы доказательств | `REQ-NFR-0010`, `REQ-NFR-0015`, `REQ-NFR-0016`, `REQ-OPS-0024` | `docs/governance/GOV-0002-equivalence-criteria.md` | | |
| 11 | Требования имеют “как проверять” | Для каждого `REQ-*` в `AR-0001` указана верификация (test/run/harness) | `REQ-*` (все) | `docs/requirements/AR-0001-*.md` | | |
| 12 | Test‑to‑test база определена | Есть Rust test‑matrix и он используется как SoT для портирования тестов | `REQ-OPS-0024` | `docs/tests/TESTMAT-0001-rust-test-matrix.md` | | |
| 13 | Golden runs и протокол | Есть протокол golden runs и внешние артефакты результатов | `REQ-OPS-0024`, `REQ-OPS-0030` | `docs/reports/REP-0001-rust-golden-runs.md` + артефакты Projects | | |
| 14 | Трассируемость определена | Схема `GOV-0001` и минимум позволяют связать `REQ-* → ADR/TOBE → MOD → TST/RUN` | `REQ-NFR-0014` | `docs/governance/GOV-0001-*.md`, | | |

### 1.3. Проверка To‑Be архитектуры (соответствие требованиям и управляемые границы)

| № | Проверка | Критерий PASS | Связанные `REQ-*` | Доказательство (ссылка) | Статус | Комментарий / Action |
|---:|---|---|---|---|---|---|
| 15 | `MOD-*` покрывают ключевые контуры | Определены модульные границы для CLI, правил, движка поиска/детектов, форматов/парсеров, FS/OS‑абстракций | `REQ-NFR-0014`, `REQ-NFR-0012` | `TOBE-0001` (разделы `MOD-*`) | | |
| 16 | Потоки по CLI‑командам описаны | Для `search/hunt/dump/lint/analyse *` есть end‑to‑end потоки и точки сравнения 1:1 | `REQ-FR-0001...REQ-FR-0009`, `REQ-NFR-0010` | `TOBE-0001` (потоки) | | |
| 17 | Платформенная специфичность локализована | Места OS‑специфики перечислены и изолированы в абстракциях | `REQ-NFR-0012` | `TOBE-0001` (platform notes) | | |
| 18 | Детерминизм учтён как инвариант | Архитектура не требует недетерминированных порядков; описаны места сортировки/стабилизации | `REQ-NFR-0011` | `TOBE-0001` + `ADR-0011` | | |

### 1.4. Проверка ADR baseline (решения управляемы, pending — прозрачны)

| № | Проверка | Критерий PASS | Связанные `REQ-*` | Доказательство (ссылка) | Статус | Комментарий / Action |
|---:|---|---|---|---|---|---|
| 19 | Все ADR индексированы | перечисляет `ADR-0001...` со статусами | `REQ-OPS-0023`, `REQ-OPS-0024` | | | |
| 20 | Архитектурно‑значимые решения приняты/отложены явно | Нет “скрытых” решений: либо Accepted, либо Pending с критериями выбора | `REQ-NFR-0016`, `REQ-OPS-0024` | `docs/adr/*` | | |
| 21 | Pending‑решения не блокируют старт | Для pending‑тем указано, на каком шаге они становятся блокерами и какой вход нужен | `REQ-OPS-0024` | `ADR-0009` + `WBS-0001` | | |

### 1.5. Риски/допущения и безопасность (ИБ‑домен)

| № | Проверка | Критерий PASS | Связанные `REQ-*` | Доказательство (ссылка) | Статус | Комментарий / Action |
|---:|---|---|---|---|---|---|
| 22 | Риски актуальны | У каждого `RISK-*` есть влияние/приоритет/план закрытия или статус Accepted | `REQ-OPS-0024` | | | |
| 23 | Нет P1 без плана | Нет открытых P1‑рисков без конкретного плана закрытия | `REQ-OPS-0024` | | | |
| 24 | Недоверенные входы учтены | Требования SEC и инженерные меры описаны (валидация, лимиты, temp, traversal, UB) | `REQ-SEC-0017...REQ-SEC-0022` | `AR-0001`, `GUIDE-0001` | | |
| 25 | FS‑эффекты и temp‑политика согласованы | Архитектура и гайд содержат правила для временных файлов/каталогов и побочных эффектов | `REQ-SEC-0018...REQ-SEC-0021`, `REQ-OPS-0029` | `AR-0001`, `GUIDE-0001`, `ADR-0010` | | |

### 1.6. Комплаенс: лицензии, данные, воспроизводимость

| № | Проверка | Критерий PASS | Связанные `REQ-*` | Доказательство (ссылка) | Статус | Комментарий / Action |
|---:|---|---|---|---|---|---|
| 26 | Политика third‑party | `POL-0001` определяет правила vendoring/NOTICE/атрибуции и исключения | `REQ-OPS-0026`, `REQ-OPS-0028` | `docs/licensing/POL-0001-third-party-policy.md` | | |
| 27 | Реестр лицензий зависимостей | `LIC-0002` содержит список зависимостей со статусами Planned/Vendored/Verified | `REQ-OPS-0026` | `docs/licensing/LIC-0002-cpp-dependencies.md` | | |
| 28 | Политика тестовых данных | Определено, что хранится в репо, что остаётся внешним и как обеспечить воспроизводимость | `REQ-OPS-0025`, `REQ-OPS-0027` | (будет финализировано на; промежуточные правила — в `POL-0001`) | | |
| 29 | Runbook для внешних прогонов предусмотрен | В WBS запланированы runbook’и и протоколы для прогонов вне среды разработки | `REQ-OPS-0030` | `WBS-0001` | | |

---

## 2) Критерии «готово к старту реализации» (перед )

### 2.1. MUST (без этого старт реализации запрещён)
1) Пройден чек‑лист раздела 1 с результатом:
 - **PASS**, или
 - **PASS-with-risks** (при этом список рисков/исключений зафиксирован в протоколе, и они не блокируют ).
2) Сформирован и утверждён протокол согласования (см. шаблон в разделе 3).
3) Все документы из раздела “Входы” существуют и являются актуальными SoT для своих классов.
4) Нет открытых P1‑рисков без плана закрытия.
5) Pending‑решения (например, по парсерам из `ADR-0009`) **явно перечислены** и в протоколе указано:
 - почему они не блокируют,
 - на каком шаге станут блокерами,
 - какой вход/эксперимент нужен для закрытия.

### 2.2. SHOULD (желательно до /27, но не блокирует )
- Имеются предварительные наброски структуры будущего diff‑harness и CI‑матрицы (будет реализовано на –27).
- Уточнён минимальный набор тестовых данных, подлежащий хранению/внешнему размещению (будет формализовано на ).

### 2.3. Допустимые открытые вопросы при старте реализации (если зафиксированы)
- Выбор конкретных EVTX/HVE/MFT/XML парсеров (pending в `ADR-0009`) — допускается как открытый вопрос на –25, если реализация идёт через абстракции `MOD-*` и не требует конкретного парсера на уровне скелета.

---

## 3) Шаблон протокола согласования архитектуры

> Рекомендованное имя файла протокола: `docs/reports/Architecture_Approval_<YYYY-MM-DD>.md`

```markdown
# Протокол согласования архитектуры (To‑Be) — <YYYY-MM-DD>

## Контекст
- Основание: (пакет согласования архитектуры), подготовка к (после )
- Объект согласования: To‑Be документы –22

## Участники
- Роль / ФИО:
 - <...>

## Перечень рассмотренных артефактов
- `TASK-0001` — `docs/requirements/TASK-0001-problem-statement.md`
- `AR-0001` — `docs/requirements/AR-0001-architectural-requirements.md`
- `ADR-0001...ADR-0011` — `docs/adr/*` +
- `TOBE-0001` — `docs/architecture/TOBE-0001-cpp-to-be-architecture.md`
- `WBS-0001` — `docs/planning/WBS-0001-work-breakdown-and-estimates.md`
- `GUIDE-0001` — `docs/guide/GUIDE-0001-developer-guide.md`
- `GOV-0001`, `GOV-0002`, `POL-0001`, `LIC-0002`
- Реестры:,,,

## Результаты чек‑листа (сводно)
- PASS: <кол-во>
- FAIL: <кол-во>
- N/A: <кол-во>

### Детали
- <вставить заполненную таблицу чек‑листа или приложить ссылкой>

## Решение
Выберите одно:
- PASS
- PASS-with-risks
- FAIL

## Принятые риски / исключения (если PASS-with-risks)
- RISK-____: <кратко> — <обоснование принятия> — <условие пересмотра>

## Action items (если есть)
| № | Описание | Владелец | Дедлайн | Связанные ID (REQ/ADR/RISK) |
|---:|---|---|---|---|
| 1 | | | | |

## Приложения
- <ссылки на артефакты/диффы/отчёты>
```

