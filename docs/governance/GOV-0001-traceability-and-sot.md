# GOV-0001 — Схема идентификаторов, трассируемость и Single Source of Truth

## Цель
Задать единые, проверяемые правила:
1) **идентификации сущностей** проекта (требования/решения/риски/тесты/модули/слайсы);
2) **трассируемости** между ними;
3) **Single Source of Truth (SoT)** для классов информации (чтобы исключить дублирование и противоречия).

Документ применяется ко всем будущим артефактам проекта, а также к коду/тестам.

## Объём
- Вводятся **форматы ID**, правила назначения и ссылки.
- Фиксируется **карта документов SoT**.
- Определяются **правила ведения реестра артефактов**.

> Важно: этот документ не задаёт To‑Be архитектуру и не выбирает библиотеки. Он определяет только управляемую схему фиксации фактов/решений/проверок.

## Термины
- **SoT (Single Source of Truth)** — единственное место, где формулируется истина для класса информации.
- **Логический тест (`TST-*`)** — единица проверки «что именно проверяем» (не привязана к конкретному фреймворку/языку).

---

## 1) Идентификаторы сущностей (ID scheme)

### 1.1. Общий формат
- Базовый формат: `PREFIX-NNNN`.
 - `PREFIX` — латиница в верхнем регистре.
 - `NNNN` — 4 цифры с ведущими нулями.
- Для требований допускается уточнение класса: `REQ-<CLASS>-NNNN`.

**Требования к ID:**
- **уникальность** в пределах типа сущности;
- **стабильность** (ID не меняется при переименовании/переносе файла);
- **grep-friendly** (ID должен находиться поиском по репозиторию);
- **кроссплатформенность** (только ASCII/цифры/дефис, без пробелов).

### 1.2. Обязательные префиксы (ключевые сущности)

| Префикс | Сущность | Где назначается (SoT) | Где используется |
|---|---|---|---|
| `ART-NNNN` | Артефакт (любой значимый объект учёта) | | индекс результатов шагов, доказательства, внешние входы |
| `REQ-<CLASS>-NNNN` | Требование (FR/NFR/SEC/OPS) | `docs/requirements/AR-*.md` | ADR/архитектура/тесты/трассировка |
| `DEC-NNNN` | Раннее решение (до пакета ADR) | `docs/decisions/DEC-*.md` + индекс | управление проектом, комплаенс |
| `ADR-NNNN` | Архитектурное решение (после –18) | `docs/adr/ADR-*.md` + индекс | To‑Be архитектура, реализация, тесты |
| `RISK-NNNN` | Риск | | решения/тесты/трассировка |
| `TST-NNNN` | Логический тест (test‑to‑test единица) | `docs/tests/TESTMAT-*.md` | C++ тесты, отчёты прогонов, трассировка |
| `MOD-NNNN` | Компонент/модуль (граница в архитектуре) | `docs/architecture/TOBE-*.md` | трассировка, код, тесты |
| `SLICE-NNNN` | Слайс портирования (вертикальная единица) | `docs/porting/BACKLOG-*.md` + статус в | шаги 31–33, отчёты, трассировка |

### 1.3. Документные ID (по категориям)
В проекте допускаются специализированные идентификаторы документов в именах файлов/заголовках (например: `INV-0001`, `BASELINE-0001`, `LIC-0001`, `POL-0001`, `GOV-0001`).

Правило:
- такой документ остаётся **единственным** SoT для своего содержания;
- при этом он **дополнительно** регистрируется как артефакт в с ID `ART-*`.

Это позволяет одновременно:
- иметь человекочитаемые ID для доменных документов;
- иметь единый сквозной индекс артефактов шагов.

### 1.4. Дополнительные префиксы (по мере необходимости)
Эти типы вводятся по мере появления соответствующих артефактов. Их использование **рекомендуется** для усиления доказательной базы.

| Префикс | Сущность | Пример применения |
|---|---|---|
| `RUN-NNNN` | Эталонный сценарий запуска (golden run) | протоколы /27 |
| `REP-NNNN` | Отчёт (прогоны/дифф/аудит/верификация) | отчёты /33/34/41/42 |
| `GATE-NNNN` | Gate‑review отчёт |, B→D, D→E, E→F |

### 1.5. Правила присвоения ID
1) **Артефакты (`ART-*`)**
 - Присваиваются последовательной нумерацией в.
 - В реестр попадает любой объект, влияющий на воспроизводимость/эквивалентность/комплаенс.

2) **Требования (`REQ-*`)**
 - Класс: `FR` / `NFR` / `SEC` / `OPS`.
 - Нумерация последовательная в рамках общего списка требований.
 - SoT для формулировок — документ AR. В других документах требования **не дублируются**, только ссылаются по `REQ-*`.

3) **Решения (`DEC-*`/`ADR-*`)**
 - До формирования ADR‑пакета (–18) допустимы `DEC-*`.
 - После новые архитектурно‑значимые решения фиксируются как `ADR-*`.
 - Индекс решений —.

4) **Риски (`RISK-*`)**
 - Риск создаётся, если есть неопределённость/угроза срокам/эквивалентности/кроссплатформенности/комплаенсу.
 - Каждый риск обязан иметь план закрытия (или явное принятие с обоснованием).

5) **Тесты (`TST-*`)**
 - `TST-*` обозначает **логическую проверку**, а не конкретную реализацию на Rust/C++.
 - SoT тест‑матрицы и назначения `TST-*` — `docs/tests/TESTMAT-*.md`.
 - Матрица связывает `TST-*` с:
 - upstream Rust тестом (путь/имя),
 - будущим C++ тестом (путь/имя),
 - фикстурами/данными,
 - покрываемыми требованиями/фичами.
 - Рекомендуемое правило для C++: включать `TST-*` в имя теста и/или имя файла, чтобы обеспечить прямую трассируемость и поиск.

6) **Модули (`MOD-*`)**
 - Присваиваются на уровне To‑Be архитектуры и используются как устойчивые якоря для трассировки.

7) **Слайсы (`SLICE-*`)**
 - Создаются в портинг‑бэклоге.
 - Активный слайс фиксируется в.

---

## 2) Single Source of Truth (SoT): карта документов

Цель SoT: у каждого класса информации есть **ровно одно** место, где она формулируется «как истина». Остальные документы **только ссылаются** на неё.

### 2.1. SoT‑таблица (верхний уровень)

| Класс информации | Single Source of Truth | Комментарий |
|---|---|---|
| Схема идентификаторов, SoT и правила трассировки | `docs/governance/GOV-0001-traceability-and-sot.md` | этот документ |
| Критерии эквивалентности 1:1 и доказательная база приёмки | `docs/governance/GOV-0002-equivalence-criteria.md` | проверяемое определение «1:1» и правила доказательной базы |
| План работ и операционные правила | внешние артефакты проекта:, | не дублируются в репозитории |
| Текущее состояние/блокеры/активный слайс | | обновляется каждую итерацию |
| Реестр артефактов | | индексирует всё значимое (включая внешние артефакты) |
| Реестр рисков | | единый журнал неопределённостей/планов закрытия |
| Индекс решений | | индекс DEC/ADR |
| Трассируемость (матрица связей) | | минимальная матрица на ранних шагах, расширяется далее |
| Текст решения (детали) | `docs/decisions/DEC-*.md` и `docs/adr/ADR-*.md` | один файл = одно решение |
| Baseline‑происхождение upstream | `docs/baseline/BASELINE-*.md` | источник истины для «что портируем» |
| Лицензии/third‑party политика | `docs/licensing/LIC-*.md`, `docs/licensing/POL-*.md` | комплаенс‑истина |
| As‑Is поведенческая истина Rust | `docs/as_is/*` (–14) | CLI/фичи/архитектура/форматы/зависимости/тесты/прогоны |
| Требования (FR/NFR/SEC/OPS) | `docs/requirements/AR-*.md` | формулировки требований только здесь |
| To‑Be архитектура | `docs/architecture/TOBE-*.md` | источник истины для модулей и границ |
| WBS/оценка | `docs/planning/WBS-*.md` | не дублировать в README |
| Developer guide | `docs/guide/GUIDE-*.md` | правила разработки/качества |
| Пакет согласования архитектуры | `docs/governance/GOV-0003-architecture-approval-package.md` | чек‑лист согласования, шаблон протокола, критерии готовности к старту реализации |
| Тест‑матрица (test‑to‑test) | `docs/tests/TESTMAT-*.md` | SoT для `TST-*` |
| Доказательства эквивалентности (отчёты/диффы) | `docs/reports/*` и/или CI artifacts (с регистрацией в ) | все доказательства должны быть учтены как артефакты |
| Реализация | каталог `cpp/` | единственная истина «как это реализовано» |

### 2.2. Правило запрета дублей
Если информация принадлежит классу из таблицы выше, то:
- в других местах разрешены только **ссылки** (ID + путь),
- запрещены копии текста требований/решений/контрактов.

---

## 3) Реестр артефактов: правила ведения

### 3.1. Что считается артефактом
Артефакт — любой объект, который влияет на:
- воспроизводимость;
- доказательства 1:1 эквивалентности;
- комплаенс (лицензии/атрибуция);
- управляемость проекта (решения/риски/протоколы).

Примеры: архивы входных данных, baseline‑паспорт, протоколы запусков, harness/скрипты, отчёты диффов, снапшоты репозитория.

### 3.2. Где ведётся реестр
Single Source of Truth для учёта артефактов:.

### 3.3. Правила заполнения
- **ID**: `ART-NNNN` (последовательная нумерация).
- **Название**: человекочитаемо, без двусмысленностей.
- **Тип**: Документ / Решение / Входные данные / Репозиторий / Артефакт (zip) / Данные / Отчёт и т.п.
- **Статус** (фиксированный словарь):
 - `External` — артефакт существует вне репозитория (Projects/CI),
 - `Imported` — добавлен в репозиторий из внешнего источника,
 - `Created` — создан в рамках проекта,
 - `Added` — добавлен как файл/данные (например, LICENSE),
 - `Generated` — создан автоматически из репозитория/пайплайна (снапшоты/отчёты).
- **Где лежит**:
 - для файлов в репозитории — путь;
 - для внешних артефактов — явное указание «артефакт проекта: …» или «CI artifact: …»;
 - для больших данных — ссылка + checksum в baseline/протоколе.
- **Шаг**: номер шага плана, где артефакт появился.

### 3.4. Мини‑чеклист при добавлении нового артефакта
1) Артефакт зарегистрирован в.
2) Если артефакт внешний — указано место хранения и способ доступа.
3) Если артефакт влияет на эквивалентность — есть ссылка на критерий/тест/дифф.
4) Если артефакт связан с риском/решением — есть ссылки по ID.

---

## 4) Мини‑правила трассируемости (как ссылаться)

### 4.1. Формат ссылок в документах
- Использовать **ID + ссылку на SoT‑файл**.
- Для реестров‑таблиц (00_*.md) допускается ссылка на файл целиком с упоминанием ID (без anchor на строку).

Пример: `RISK-0006 `.

### 4.2. Мини‑инвариант трассировки
Любая реализуемая функциональность должна иметь хотя бы одну цепочку:
`REQ-* → (ADR-*/DEC-* при наличии) → MOD-* → TST-* → REP-*/RUN-*/дифф`.

На ранних шагах (до /12/16/19/29) допускается неполная цепочка, но **она должна замыкаться** к моменту соответствующих Gate.
