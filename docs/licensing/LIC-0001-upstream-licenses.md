# LIC-0001 — Реестр лицензий upstream-источников

## Цель
Зафиксировать лицензии и обязательства по атрибуции/распространению для **входных upstream-источников**, используемых в проекте портирования Chainsaw (Rust) → C++.

## Объём (Scope)
В рамках рассматриваются только предоставленные входные источники:
- ****: Chainsaw (Rust) — архив `chainsaw.zip`
- ****: Sigma rules — архив `sigma.zip`
- ****: EVTX-ATTACK-SAMPLES — архив `EVTX-ATTACK-SAMPLES.zip`

Лицензии будущих C++ зависимостей (будут выбираться в ) **не анализируются** в этом документе.

## Связанные артефакты
- `docs/baseline/BASELINE-0001-upstream.md` — baseline коммиты/происхождение upstream
- `docs/licensing/POL-0001-third-party-policy.md` — политика работы со сторонними компонентами/данными

## Сводная таблица

| Компонент | Тип | Upstream | Baseline | Лицензия | Файл/доказательство в архиве |
|---|---|---|---|---|---|
| Chainsaw | Исходный код (Rust) + встроенные правила/фикстуры | https://github.com/WithSecureLabs/chainsaw | `c692405ecbc9703d190a67fd0679e48961a99c3a` (`v2.13.1-4-gc692405`) | GNU GPL v3 | `LICENCE` (текст GPL v3), `Cargo.toml` (`license = "GPL3"`) |
| Sigma rules | Данные (правила Sigma в YAML) | https://github.com/SigmaHQ/sigma | `2952d630a413a820fcd8b6033dbc14ac3566e554` (`r2025-12-01-20-g2952d630a`) | Detection Rule License (DRL) 1.1; спецификация и логотип — public domain | `LICENSE` (ссылка на DRL 1.1), `README.md` (секция Licenses) |
| EVTX-ATTACK-SAMPLES | Данные (EVTX файлы + скрипты) | https://github.com/sbousseaden/EVTX-ATTACK-SAMPLES | `4ceed2f4706daf601c212a8f91c113dd85349a2c` (`4ceed2f`) | GNU GPL v3 | `LICENSE.GPL` (текст GPL v3), `README.md` (секция License) |

## Детализация по компонентам

### 1) Chainsaw
- Наблюдаемо в архиве присутствует файл `LICENCE`, содержащий текст **GNU General Public License Version 3, 29 June 2007**.
- В `Cargo.toml` в секции `[package]` указано `license = "GPL3"`.

**Ограничения/обязательства (высокоуровнево):**
- При распространении производных работ требуется соблюдение условий GPL v3 (распространение исходников, сохранение лицензии и т.д.).
- Подробные правила по оформлению в этом репозитории: см. `POL-0001`.

### 2) Sigma rules
- В файле `LICENSE` явно указано:
 - спецификация Sigma и логотип — public domain;
 - правила SigmaHQ — **Detection Rule License (DRL) 1.1**.

**Ключевые обязательства DRL 1.1 (высокоуровнево):**
- При распространении правил (включая модифицированные) должны сохраняться атрибуты автора, ссылка/URI на правило/набор правил и ссылка/текст лицензии (в разумно возможной мере).
- При использовании правил на данных сообщения/результаты, основанные на срабатываниях, должны сохранять идентификацию автора (если она есть в правиле).

> Важное следствие для порта: нельзя «терять» поле `author` и связанные метаданные Sigma-правил при загрузке/трансформациях и при формировании сообщений о совпадениях.

### 3) EVTX-ATTACK-SAMPLES
- В архиве присутствует файл `LICENSE.GPL` с текстом **GNU General Public License Version 3, 29 June 2007**.
- В `README.md` явно указана лицензия датасета (ссылка на `LICENSE.GPL`).

**Ограничения/обязательства (высокоуровнево):**
- При распространении датасета или его частей необходимо соблюдать условия GPL v3 и сохранять файл лицензии.
- Политика включения тестовых данных в репозиторий порта формализуется отдельно в (см. RISK-0003).

## Неопределённости (если понадобится уточнение)
1) **SPDX-идентификаторы и режим "only" vs "or-later"** для GPL в upstream-источниках.
 - В предоставленных архивах присутствует текст GPL v3, однако не все проекты явно маркируют режим `-only`/`-or-later`.
 - До появления явных указаний будем трактовать как минимум как "GPL v3" и действовать максимально консервативно (см. `POL-0001`).

2) **Внутренние файлы/скрипты EVTX-ATTACK-SAMPLES** (например, сторонние Python-скрипты/ноутбуки) могут содержать дополнительные лицензии.
 - Пока датасет не коммитится в репозиторий (см. политику), риски минимизированы.

