# Run Report: SLICE-015 HVE Parser Implementation
Date: 2026-01-12

## Summary
**PASS** — SLICE-015 (HVE Parser) successfully implemented and verified on all 3 platforms.

## Test Results

### Linux (192.168.5.75)
- **Build:** SUCCESS (GCC 14.2.0)
- **Tests:** 382/382 PASS
- **HVE Tests:** 19/19 PASS

### macOS (192.168.5.221)
- **Build:** SUCCESS (AppleClang 17.0.0)
- **Tests:** 382/382 PASS
- **HVE Tests:** 19/19 PASS

### Windows (192.168.5.178)
- **Build:** SUCCESS (MSVC 19.44.35222.0)
- **Tests:** 382/382 PASS
- **HVE Tests:** 19/19 PASS

## Implementation Details

### ADR-0009 Decision
- **Решение:** собственная реализация REGF парсера на C++
- **Причина:** ни libregf, ни windows-hive-parser не поддерживают transaction logs
- **Known Limitation:** transaction logs (.LOG,.LOG1,.LOG2) НЕ поддерживаются
 - Соответствует baseline (notatin также не применяет logs)

### Files Created
| File | Lines | Purpose |
|------|-------|---------|
| `cpp/include/chainsaw/hve.hpp` | ~260 | HVE Parser API definitions |
| `cpp/src/io/hve.cpp` | ~1100 | REGF format parser implementation |
| `cpp/tests/test_hve_gtest.cpp` | ~445 | Unit tests |
| `cpp/tests/fixtures/hve/test_minimal.hve` | binary | Valid hive fixture (synthetic) |
| `cpp/tests/fixtures/hve/invalid.hve` | 1 | Invalid file fixture |

### Modified Files
| File | Change |
|------|--------|
| `cpp/src/io/reader.cpp` | Added HVE integration to Reader::open |
| `cpp/CMakeLists.txt` | Added hve.cpp to chainsaw_reader |
| `cpp/tests/CMakeLists.txt` | Added test_hve_gtest target |

### REGF Parser Features
- Full REGF format support
- All value types: REG_SZ, REG_MULTI_SZ, REG_DWORD, REG_QWORD, REG_BINARY
- Case-insensitive key lookup (Windows Registry semantics)
- UTF-16LE → UTF-8 conversion
- FILETIME → chrono::time_point conversion
- DFS iterator for traversing all keys
- Fallback chain position 5 for unknown extensions

## Test Coverage

### Spec Tests (TST-HVE-001..015)
| Test ID | Name | Status |
|---------|------|--------|
| TST-HVE-001 | Load_ValidHive | PASS |
| TST-HVE-002 | Load_WithTransactionLogs | PASS |
| TST-HVE-003 | Load_InvalidFile | PASS |
| TST-HVE-004 | GetKey_ValidPath | PASS |
| TST-HVE-005 | GetKey_InvalidPath | PASS |
| TST-HVE-006 | ReadSubKeys | PASS |
| TST-HVE-007 | ValueIter | PASS |
| TST-HVE-008 | CellValue_Binary | PASS |
| TST-HVE-009 | CellValue_U32 | PASS |
| TST-HVE-010 | CellValue_U64 | PASS |
| TST-HVE-011 | CellValue_String | PASS |
| TST-HVE-012 | CellValue_MultiString | PASS |
| TST-HVE-013 | KeyLastModified | PASS |
| TST-HVE-014 | Reader_Integration | PASS |
| TST-HVE-015 | Fallback_Position | PASS |

### Additional Tests
| Test | Status |
|------|--------|
| Load_NonExistentFile | PASS |
| Iterator_TraverseAllKeys | PASS |
| RegValueType_ToString | PASS |
| GetKey_CaseInsensitive | PASS |

## Issues Resolved
1. **Linker error** — `RegKey::get_value` was declared but not implemented; added implementation
2. **Iterator bug** — paths were incorrectly including root key name; fixed path building logic
3. **macOS CMake** — yaml-cpp CMake compatibility; added `-DCMAKE_POLICY_VERSION_MINIMUM=3.5`

## Artifacts
- Total C++ unit tests: **382** (was 363, added 19)
- Test run time: ~1.5s (Linux), ~1.2s (macOS), ~6.2s (Windows)
- Binary size change: minimal (static library)

## Verification Checklist
- [x] All spec tests pass (TST-HVE-001..015)
- [x] Cross-platform build (Linux/macOS/Windows)
- [x] Cross-platform tests (382/382 on all)
- [x] No regressions in existing tests
- [x] ADR-0009 updated with decision
- [x] NEXT.md updated

## Next Step
: SLICE-016 UnitReady (ESEDB Parser)
