# Review — 2026-01-09

## Решение

**PASS**

Готовность к переходу в фазу F (цикл портирования) подтверждена по всем критериям.

---

## Критерии (из )

> PASS, если: есть воспроизводимый цикл configure/build/test; CI проверяет целевые ОС; harness дифф-сравнения работает; политика данных определена.

---

## G1. Доказательства: воспроизводимый цикл configure/build/test

**Статус: PASS**

### Факты

| Платформа | Компилятор | Configure | Build | Test | Результат |
|-----------|------------|-----------|-------|------|-----------|
| Linux | GCC 14.2.0 | OK | OK | 48/48 PASS | **PASS** |
| macOS | AppleClang 17.0.0 | OK | OK | 48/48 PASS | **PASS** |
| Windows | MSVC 19.44.35222 | OK | OK | 48/48 PASS | **PASS** |

### Команды проверки (выполнены 2026-01-09)

**Linux:**
```bash
cd ~/cpp && mkdir build && cd build && cmake.. && cmake --build. -j && ctest
# Result: 100% tests passed, 0 tests failed out of 48
```

**macOS:**
```bash
cd ~/cpp && mkdir build && cd build && cmake.. && cmake --build. -j && ctest
# Result: 100% tests passed, 0 tests failed out of 48
```

**Windows:**
```bash
cd C:\Users\user\cpp && mkdir build && cd build && cmake.. -G "Visual Studio 17 2022" && cmake --build. --config Release && ctest -C Release
# Result: 100% tests passed, 0 tests failed out of 48
```

### Артефакты

- `cpp/CMakeLists.txt` — система сборки
- `cpp/tests/` — тесты GoogleTest
- `cpp/README.md` — инструкции сборки

---

## G2. Проверяемость: CI проверяет целевые ОС

**Статус: PASS**

### Факты

GitHub Actions CI workflow: `.github/workflows/ci.yml`

| Job | Платформа | Описание | Статус |
|-----|-----------|----------|--------|
| linux-gcc | Ubuntu | Release + Debug | Настроен |
| linux-asan | Ubuntu | Debug + AddressSanitizer | Настроен |
| linux-ubsan | Ubuntu | Debug + UndefinedBehaviorSanitizer | Настроен |
| macos | macOS | Release + Debug | Настроен |
| macos-asan | macOS | Debug + AddressSanitizer | Настроен |
| windows | Windows | Release + Debug | Настроен |
| ci-success | All | Итоговая проверка всех jobs | Настроен |

**Итого: 10 CI jobs** покрывают 3 платформы + санитайзеры.

### Артефакты

- `.github/workflows/ci.yml`
- `docs/governance/POL-0002-green-state-policy.md`
- `tools/ci/build.sh`, `tools/ci/build.ps1`,

---

## G3. Трассируемость: harness дифф-сравнения работает

**Статус: PASS**

### Факты

Harness `tools/harness/compare_behavior.py` выполнен успешно:

```
[INFO] Harness сравнения поведения
[INFO] Golden dir: golden/rust_golden_runs_linux_x86_64
[INFO] C++ binary: cpp/build/chainsaw
[INFO] Scenarios: 4

 unknown subcommand... FAIL (exit_code: golden=2, actual=1.)
 dump без обязательного path... FAIL
 lint --help... FAIL
 lint --kind stalker... FAIL (exit_code: golden=2, actual=0.)

[SUMMARY] Total: 4, PASS: 0, FAIL: 4
```

**Интерпретация**: Harness работает корректно. FAIL ожидаем — C++ реализация содержит заглушки без функциональной логики. Это baseline для регресс-тестирования в фазе F.

### Golden runs доступны

| Платформа | Каталог | Сценариев |
|-----------|---------|-----------|
| Linux | `golden/rust_golden_runs_linux_x86_64/` | 19 |
| macOS | `golden/rust_golden_runs_macos_x86_64/` | 19 |
| Windows | `golden/rust_golden_runs_windows_x86_64/` | 19 |

### Артефакты

- `tools/harness/compare_behavior.py`
- `tools/harness/README.md`
- `docs/reports/REP-0002-harness-comparison-baseline.md`

---

## G4. Консистентность: политика данных определена

**Статус: PASS**

### Факты

Политика тестовых данных: `docs/licensing/POL-0003-test-data-policy.md`

**Категоризация:**

| Категория | Критерий | Примеры | Статус |
|-----------|----------|---------|--------|
| A: INCLUDE | < 1 MB, GPL/DRL совместимо | EVTX samples, Sigma rules | Включены в `cpp/tests/fixtures/` |
| B: REFERENCE-ONLY | >= 1 MB | SRUM fixtures (~76 MB) | Инструкция в `fixtures/srum/README.md` |
| C: EXTERNAL | Внешние датасеты | sigma.zip, EVTX-ATTACK-SAMPLES.zip | Не включаются |

**Минимальный набор фикстур:**

```
cpp/tests/fixtures/
├── LICENSE # GPL v3
├── README.md # Происхождение и правила
├── evtx/ # 68 KB (TST-0001..TST-0004)
├── sigma/ # 1.7 KB (TST-0007, TST-0008)
└── srum/README.md # Инструкция для B-категории
```

**Размер:** 132 KB (в пределах Категории A).

### Артефакты

- `docs/licensing/POL-0003-test-data-policy.md`
- `docs/tests/FIX-0001-cpp-test-fixtures.md`
- `cpp/tests/fixtures/`

---

## Риски на переход (допускаются в фазу F)

| RISK-ID | Описание | Статус | Обоснование допуска |
|---------|----------|--------|---------------------|
| RISK-0011 | Платформенные расхождения вывода | Open | Контролируется harness; ADR-0006/ADR-0011 определяют политику |
| RISK-0030 | Отсутствие готового C++ стека для EVTX/HVE/MFT | Open | Стратегия ADR-0009; слайсы -33 |
| RISK-0031 | Сложность byte-to-byte CLI help/errors | Open | ADR-0006 определяет собственный CLI слой |
| RISK-0032 | Интеграция C-зависимостей (libyal) | Open | ADR-0002 vendoring; верификация при добавлении |
| RISK-0038 | SSH/SCP совместимость на VM | Open | Верифицировано реальным подключением 3 VM |

**Pending решения (не блокируют Gate):**

- ADR-0009: парсеры EVTX/HVE/MFT/XML — выбор будет при реализации слайсов

---

## Чек-лист готовности к фазе F

- [x] Configure/build/test работает на 3 ОС
- [x] CI workflow настроен для 3 платформ
- [x] Harness сравнения функционирует
- [x] Golden runs Rust доступны для 3 платформ
- [x] Политика тестовых данных определена
- [x] Минимальный набор фикстур включён в репозиторий
- [x] 3-VM протокол верифицирован реальным подключением
- [x] Риски формализованы и допущены на переход

---

## Заключение

**: PASS**

Фаза E (инженерный фундамент C++) завершена. Все критерии готовности к циклу портирования выполнены. Проект готов к началу (портинг-бэклог).

---

## Связанные документы

- — план работ
- — состояние проекта
- `docs/governance/GOV-0002-equivalence-criteria.md` — критерии 1:1
- `docs/reports/Gate_D_E_2026-01-03.md` — предыдущий gate
